webpackJsonp([2],{"32Ge":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("js5j"),r=a("vzcQ"),n={extends:s.a,activated:function(){console.log("activated-add"),this.$store.commit(r.a.STORE_NAME+"/setParams",this.$route.query),"ADD"==this.$route.query.ACTION?this.$callAction({action:r.a.STORE_NAME+"/add",param:this.$route.query,isErrorBack:!0,timeOut:600}):"VIEW"==this.$route.query.ACTION?this.$callAction({action:r.a.STORE_NAME+"/open",param:this.$route.query.DID,isErrorBack:!0,timeOut:600}):(this.$alert("参数不合法！"),this.$router.goBack(!0))}},i=a("C7Lr")(n,null,!1,null,null,null);e.default=i.exports},"E/ur":function(t,e){},Et8i:function(t,e,a){"use strict";e.a=async function(t){return new Promise(function(e,a){try{e(t())}catch(t){a(t)}})}},R7OH:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s={extends:a("js5j").a},r=a("C7Lr")(s,null,!1,null,null,null);e.default=r.exports},UOUA:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("lC5x"),r=a.n(s),n=a("J0Oq"),i=a.n(n),o=a("+9g/"),c=a("JIbx"),u={name:"list",props:{TITLE:{type:String,default:"订货管理"}},data:function(){return{list:[],topStatus:"",allLoaded:!1,openParam:{},SDATE:Object(c.c)(Object(c.a)(new Date,"d",1)),EDATE:Object(c.c)(Object(c.a)(new Date,"d",1)),SNODECODE:this.$store.getters.userInfo.SNODECODE,AMT:0}},methods:{open:function(t){this.$refs[t].open()},changeDate:function(t,e){var a=parseInt(t.replace(/\-/g,"")),s=parseInt(e.replace(/\-/g,""));a>s?this.EDATE=this.SDATE:s>a+31&&(this.EDATE=Object(c.c)(Object(c.a)(new Date(t),"d",31)))},linkBVSale:function(t,e){var a=void 0;e&&(a=e.BILLID),this.$router.push({path:"/bvsale",query:{ACTION:t,DID:a}})},setOpenParam:function(){this.openParam={modalName:"VSL_SALE_QRY_4MOBILE",where:" SNODECODE = NVL('"+this.SNODECODE+"',SNODECODE) AND AID=@AID AND BILLTYPEID = '232'  AND BUSTYPEID=100993 AND  MSTYPEID=10354  AND BILLDATE >= TO_DATE('"+this.SDATE+"','YYYY-MM-DD') AND BILLDATE <= TO_DATE('"+this.EDATE+"','YYYY-MM-DD') AND [SNODEID] IN(SELECT COLUMN_VALUE FROM TABLE(tss_getpowwhere('SNODE','@UID','@AID')) UNION ALL SELECT "+(this.$store.state.user.userInfo.SNODEID||0)+" FROM DUAL)",orderBy:"BILLDATE,BILLCODE",pageSize:25,pageIndex:1}},doQuery:function(){var t=i()(r.a.mark(function t(){var e=this;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.topStatus="loading",this.allLoaded=!1,this.setOpenParam(),t.next=5,this.$callAsync({method:o.a.open,params:[this.openParam]}).then(function(t){e.list=t.data.items,e.topStatus="",e.$refs.loadmore.onTopLoaded()});case 5:return t.next=7,this.$callAsync({method:o.a.open,params:[{sqlId:"51515",SNODECODE:this.SNODECODE,SNODEID:this.$store.state.user.userInfo.SNODEID||0,SDATE:this.SDATE,EDATE:this.EDATE}]}).then(function(t){e.AMT=t.data.items[0].AMT});case 7:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),doQueryNext:function(){var t=i()(r.a.mark(function t(){var e=this;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.openParam.pageIndex++,this.topStatus="loading",t.next=4,this.$callAsync({method:o.a.open,params:[this.openParam]}).then(function(t){e.topStatus="",t.data.items.forEach(function(t){e.list.push(t)}),e.$refs.loadmore.onBottomLoaded(),0==t.data.items.length&&(e.allLoaded=!0)});case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},created:function(){this.SDATE=this.$route.query.SDATE||Object(c.c)(Object(c.a)(new Date,"d",1)),this.EDATE=this.$route.query.EDATE||Object(c.c)(Object(c.a)(new Date,"d",1)),this.SNODECODE=this.$route.query.SNODECODE||this.$store.getters.userInfo.SNODECODE,this.$callAsync({method:this.doQuery,params:[],timeOut:600})},watch:{SDATE:function(){this.changeDate(this.SDATE,this.EDATE)},EDATE:function(){this.changeDate(this.SDATE,this.EDATE)}}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mui-layout mui-layout-top"},[a("rs-header",{attrs:{title:t.TITLE,color:"primary"}},[a("a",{staticClass:"mui-icon mui-icon-left-nav mui-pull-left",attrs:{slot:"left"},on:{click:function(e){t.$router.goBack()}},slot:"left"}),t._v(" "),a("div",{attrs:{slot:"right"},slot:"right"},[t.$store.getters.pcode["salemanage.add"]?a("rs-button",{attrs:{link:""},on:{click:function(e){t.linkBVSale("ADD")}}},[t._v("+订货")]):t._e()],1)]),t._v(" "),a("rs-list",{staticClass:"rr-line-24 mb10",attrs:{size:"15",noborder:""}},[a("rs-list-item",{attrs:{isright:""},nativeOn:{click:function(e){t.open("picker2")}}},[a("div",{staticClass:"rs-flex-row"},[a("span",{staticClass:"rr-justify rr-width-4em"},[t._v("开 始 日 期")]),t._v(" "),a("span",[t._v("：")]),t._v(" "),a("div",{staticClass:"rs-flex-item"},[t._v("\n            "+t._s(t._f("getWeek")(t.SDATE))+"\n        ")])])]),t._v(" "),a("rs-list-item",{attrs:{isright:""},nativeOn:{click:function(e){t.open("picker3")}}},[a("div",{staticClass:"rs-flex-row"},[a("span",{staticClass:"rr-justify rr-width-4em"},[t._v("结 束 日 期")]),t._v(" "),a("span",[t._v("：")]),t._v(" "),a("div",{staticClass:"rs-flex-item"},[t._v("\n            "+t._s(t._f("getWeek")(t.EDATE))+"\n        ")])])]),t._v(" "),a("rs-list-item",{attrs:{noborder:""}},[a("div",{staticClass:"rs-flex-row"},[a("span",{staticClass:"rr-justify rr-width-4em"},[t._v("网 点 编 号")]),t._v(" "),a("span",[t._v("：")]),t._v(" "),a("div",{staticClass:"rs-flex-item"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.SNODECODE,expression:"SNODECODE"}],staticClass:"rr-input-w100",attrs:{type:"text",placeholder:"点击输入"},domProps:{value:t.SNODECODE},on:{input:function(e){e.target.composing||(t.SNODECODE=e.target.value)}}})]),t._v(" "),a("rs-button",{staticClass:"rr-list-search",attrs:{size:"small"},on:{click:t.doQuery}},[t._v("查询")])],1),t._v(" "),""!=t.SNODECODE?a("span",{staticClass:"rr-list-clear rr-font rr-quxiao",on:{click:function(e){e.stopPropagation(),t.SNODECODE=""}}}):t._e()])],1),t._v(" "),a("rs-datetime",{key:"bvsale.2",ref:"picker2",attrs:{type:"date"},model:{value:t.SDATE,callback:function(e){t.SDATE=e},expression:"SDATE"}}),t._v(" "),a("rs-datetime",{key:"bvsale.3",ref:"picker3",attrs:{type:"date"},model:{value:t.EDATE,callback:function(e){t.EDATE=e},expression:"EDATE"}}),t._v(" "),a("div",{staticClass:"mui-content"},[t.list.length<=0?a("div",{staticClass:"rs-list-nodata"},[a("span",[t._v("无对应数据！")])]):t._e(),t._v(" "),a("rs-loadmore",{ref:"loadmore",attrs:{"bottom-method":t.doQueryNext,"top-status":t.topStatus,"bottom-all-loaded":t.allLoaded,"top-method":t.doQuery,"auto-fill":!1},on:{"update:topStatus":function(e){t.topStatus=e}}},[a("rs-list",{staticClass:"rr-line-24 rr-list-rili",attrs:{size:"14",noborder:""}},t._l(t.list,function(e){return a("rs-list-item",{key:e.BILLID,nativeOn:{click:function(a){t.linkBVSale("VIEW",e)}}},[a("div",{staticClass:"rs-flex-row"},[a("div",{staticClass:"rr-media-rili"},[a("h3",[t._v(t._s(t._f("datePart")(e.BILLDATE,"d")))]),t._v(" "),a("div",[t._v(t._s(t._f("datePart")(e.BILLDATE,"m"))+"月")])]),t._v(" "),a("div",{staticClass:"rs-flex-item f14 rr-position-re"},[a("span",{staticClass:"rr-right"},[t._v(t._s(e.MSTYPENAME))]),t._v(" "),a("div",[t._v(t._s(e.SNODECODE+"("+e.SNODENAME+")"))]),t._v("\n              单号:"+t._s(e.BILLCODE)+"\n              "),a("div",{staticClass:"f12 rr-list-rili-b"},[t._v("\n                金额:"),a("span",[t._v(t._s(t._f("toFixed")(e.AMT,2)))]),t._v("(元)\n              ")])])])])})),t._v(" "),t.allLoaded?a("div",{staticClass:"rs-list-nodata"},[a("span",[t._v("没有数据啦")])]):t._e()],1)],1),t._v(" "),t.list.length>0?a("div",{staticClass:"f14 bk-fff rs-padding-5"},[t._v("金额合计："+t._s(t._f("toFixed")(t.AMT,2))+"(元)")]):t._e()],1)},staticRenderFns:[]};var E=a("C7Lr")(u,l,!1,function(t){a("x4ez")},"data-v-b1dab61e",null);e.default=E.exports},dJKv:function(t,e){},eYLe:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("lC5x"),r=a.n(s),n=a("J0Oq"),i=a.n(n),o=a("+9g/"),c=a("9r/T"),u=a("JIbx"),l={name:"snode_sel",props:{refStore:{type:Object},singleOpen:{type:Boolean},TITLE:{type:String},STATE:{type:String,default:"Su"}},data:function(){return{list:[],topStatus:"",allLoaded:!1,searchInput:"",query:this.$route.query,openParam:{}}},methods:{setOpenParam:function(){var t=this.query.BILLDATE||Object(u.c)(new Date),e="[AID] = @AID AND [SDATE] <= TO_DATE('"+t+"','YYYY-MM-DD') AND ([EDATE] >= TO_DATE('"+t+"','YYYY-MM-DD') OR [EDATE] IS NULL)  "+("Su"==this.STATE?" AND [ISVERIFY]=1":"");this.openParam={modalName:"VBS_SNODE",where:e+" AND ([SNODECODE] LIKE '%"+this.searchInput+"%' OR [HEADCODE] LIKE '%"+this.searchInput+"%' OR [SNODENAME] LIKE '%"+this.searchInput+"%')  AND [SNODEID] IN(SELECT COLUMN_VALUE FROM TABLE(tss_getpowwhere('SNODE','@UID','@AID')) UNION ALL SELECT "+(this.$store.state.user.userInfo.SNODEID||0)+" FROM DUAL)",orderBy:"[DISTRULECODE],[ORDERCODE],[SNODECODE]",pageSize:25,pageIndex:1}},doQuery:function(){var t=this;this.topStatus="loading",this.allLoaded=!1,this.setOpenParam(),o.a.open(this.openParam).then(function(e){t.list=e.data.items,t.topStatus="",t.$refs.loadmore.onTopLoaded()})},doQueryNext:function(){var t=i()(r.a.mark(function t(){var e=this;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.openParam.pageIndex++,this.topStatus="loading",o.a.open(this.openParam).then(function(t){e.topStatus="",t.data.items.forEach(function(t){e.list.push(t)}),e.$refs.loadmore.onBottomLoaded(),0==t.data.items.length&&(e.allLoaded=!0)});case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),selectItem:function(t){var e=this,a={};a.path=this.refStore.path,a.item=t,Object(c.setTimeout)(function(){e.refStore.mutation?e.$store.commit(e.refStore.mutation,a):e.refStore.action?(e.$indicator.open(),e.$store.dispatch(e.refStore.action,a).then(function(){return e.$indicator.close()})):e.$emit("selectItem",t)},600),this.$router.goBack()}},activated:function(){var t=this;Object(c.setTimeout)(function(){t.doQuery()},600)},watch:{topStatus:function(t,e){"loading"==t?this.$indicator.open():this.$indicator.close()}}},E={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mui-layout mui-layout-top"},[a("rs-header",{attrs:{title:t.TITLE,color:"primary"}},[a("a",{staticClass:"mui-icon mui-icon-left-nav mui-pull-left",attrs:{slot:"left"},on:{click:function(e){t.$router.goBack()}},slot:"left"})]),t._v(" "),a("div",{staticClass:"mui-input-row mui-search r-search"},[a("rs-button",{staticClass:"mui-pull-right",attrs:{link:""},on:{click:t.doQuery}},[t._v("查询")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.searchInput,expression:"searchInput"}],staticClass:"mui-input-clear",staticStyle:{padding:"0 0 0 15px"},attrs:{type:"search",placeholder:"输入编码、网点名称"},domProps:{value:t.searchInput},on:{input:function(e){e.target.composing||(t.searchInput=e.target.value)}}})],1),t._v(" "),a("div",{staticClass:"mui-content"},[a("div",{staticClass:"page-loadmore-wrapper"},[a("rs-loadmore",{ref:"loadmore",attrs:{"top-method":t.doQuery,"bottom-method":t.doQueryNext,"auto-fill":!1,"bottom-all-loaded":t.allLoaded,"top-status":t.topStatus},on:{"update:topStatus":function(e){t.topStatus=e}}},[a("ul",{staticClass:"mui-table-view"},t._l(t.list,function(e){return a("li",{key:e.SNODEID,staticClass:"mui-table-view-cell",staticStyle:{"font-size":"15px"},on:{click:function(a){t.selectItem(e)}}},[a("label",{staticStyle:{width:"100px",display:"inline-block"}},[t._v(t._s(e.SNODECODE))]),t._v(t._s(e.SNODENAME)+"\n          ")])})),t._v(" "),t.allLoaded?a("div",{staticClass:"rs-list-nodata"},[a("span",[t._v("没有数据啦")])]):t._e()])],1)])],1)},staticRenderFns:[]};var D=a("C7Lr")(l,E,!1,function(t){a("dJKv")},"data-v-486c9d54",null);e.default=D.exports},js5j:function(t,e,a){"use strict";var s={name:"rs-page",data:function(){return{destroy:!0}},activated:function(){this.destroy=!1,console.log("page.activated"+this.name)},deactivated:function(){console.log("page.deactivated")},destroyed:function(){console.log("page.destroyed"+this.name)}},r={render:function(){var t=this.$createElement,e=this._self._c||t;return this.destroy?this._e():e("rs-views")},staticRenderFns:[]},n=a("C7Lr")(s,r,!1,null,null,null);e.a=n.exports},qeg8:function(t,e){},sMG5:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("lC5x"),r=a.n(s),n=a("J0Oq"),i=a.n(n),o=a("+9g/"),c=a("JIbx"),u={name:"list",props:{TITLE:{type:String,default:"订货状况"}},data:function(){return{list:[],TYPE:"0",topStatus:"",allLoaded:!1,openParam:{},SDATE:Object(c.c)(Object(c.a)(new Date,"d",1)),EDATE:Object(c.c)(Object(c.a)(new Date,"d",1)),SNODECODE:this.$store.getters.userInfo.SNODECODE}},methods:{open:function(t){this.$refs[t].open()},linkBVSale:function(t){"营业未订"==t.SLSTATENAME&&this.$router.push({path:"/bvsale",query:{ACTION:"ADD",SNODEID:t.SNODEID,BILLDATE:t.SLDATE}}),["营业已订","息业已订","期外已订"].indexOf(t.SLSTATENAME)>=0&&this.$router.push({path:"/bvsale/list",query:{SNODECODE:t.SNODECODE,SDATE:t.SLDATE,EDATE:t.SLDATE}})},setOpenParam:function(){this.openParam={sqlId:"51517",pageSize:20,SNODECODE:this.SNODECODE,SNODEID:this.$store.state.user.userInfo.SNODEID||0,SDATE:this.SDATE,EDATE:this.EDATE,TYPE:this.TYPE}},doQuery:function(){var t=i()(r.a.mark(function t(){var e=this;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.topStatus="loading",this.allLoaded=!1,this.setOpenParam(),this.$busy(),t.next=6,this.$callAsync({method:o.a.open,params:[this.openParam]}).then(function(t){e.list=t.data.items,e.topStatus="",e.$refs.loadmore.onTopLoaded()});case 6:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),doQueryNext:function(){var t=i()(r.a.mark(function t(){var e,a=this;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=this.list.map(function(t){return t.SNODEID+"-"+t.SLDATE}),this.openParam.NOTIN="'"+e.join("','")+"'",this.topStatus="loading",this.$callAsync({method:o.a.open,params:[this.openParam]}).then(function(t){a.topStatus="",t.data.items.forEach(function(t){a.list.push(t)}),a.$refs.loadmore.onBottomLoaded(),0==t.data.items.length&&(a.allLoaded=!0)});case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},created:function(){console.log("创见了：订货状况"),this.$callAsync({method:this.doQuery,params:[],timeOut:600})},destroyed:function(){console.log("销毁了完蛋了：订货状况main")},watch:{SDATE:function(){this.changeDate(this.SDATE,this.EDATE)},EDATE:function(){this.changeDate(this.SDATE,this.EDATE)},TYPE:function(){this.doQuery()}}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mui-layout mui-layout-top"},[a("rs-header",{attrs:{title:t.TITLE,color:"primary"}},[a("a",{staticClass:"mui-icon mui-icon-left-nav mui-pull-left",attrs:{slot:"left"},on:{click:function(e){t.$router.goBack()}},slot:"left"})]),t._v(" "),a("rs-list",{staticClass:"rr-line-24",attrs:{size:"15",noborder:""}},[a("rs-list-item",{attrs:{isright:""},nativeOn:{click:function(e){t.open("picker2")}}},[a("div",{staticClass:"rs-flex-row"},[a("span",{staticClass:"rr-justify rr-width-4em"},[t._v("开 始 日 期")]),t._v(" "),a("span",[t._v("：")]),t._v(" "),a("div",{staticClass:"rs-flex-item"},[t._v("\n            "+t._s(t._f("getWeek")(t.SDATE))+"\n        ")])])]),t._v(" "),a("rs-list-item",{attrs:{isright:""},nativeOn:{click:function(e){t.open("picker3")}}},[a("div",{staticClass:"rs-flex-row"},[a("span",{staticClass:"rr-justify rr-width-4em"},[t._v("结 束 日 期")]),t._v(" "),a("span",[t._v("：")]),t._v(" "),a("div",{staticClass:"rs-flex-item"},[t._v("\n            "+t._s(t._f("getWeek")(t.EDATE))+"\n        ")])])]),t._v(" "),a("rs-list-item",{attrs:{noborder:""}},[a("div",{staticClass:"rs-flex-row"},[a("span",{staticClass:"rr-justify rr-width-4em"},[t._v("网 点 编 号")]),t._v(" "),a("span",{},[t._v("：")]),t._v(" "),a("div",{staticClass:"rs-flex-item"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.SNODECODE,expression:"SNODECODE"}],staticClass:"rr-input-w100",attrs:{type:"text",placeholder:"点击输入"},domProps:{value:t.SNODECODE},on:{input:function(e){e.target.composing||(t.SNODECODE=e.target.value)}}})]),t._v(" "),a("rs-button",{staticClass:"rr-list-search",attrs:{size:"small"},on:{click:function(e){t.doQuery()}}},[t._v("查询")])],1),t._v(" "),""!=t.SNODECODE?a("span",{staticClass:"rr-list-clear rr-font rr-quxiao",on:{click:function(e){e.stopPropagation(),t.SNODECODE=""}}}):t._e()])],1),t._v(" "),a("rs-datetime",{key:"bvsale.2",ref:"picker2",attrs:{type:"date"},model:{value:t.SDATE,callback:function(e){t.SDATE=e},expression:"SDATE"}}),t._v(" "),a("rs-datetime",{key:"bvsale.3",ref:"picker3",attrs:{type:"date"},model:{value:t.EDATE,callback:function(e){t.EDATE=e},expression:"EDATE"}}),t._v(" "),a("rs-navbar",{attrs:{inverted:""},model:{value:t.TYPE,callback:function(e){t.TYPE=e},expression:"TYPE"}},[a("rs-nav-item",{attrs:{id:"0"}},[t._v("\n      全部\n    ")]),t._v(" "),a("rs-nav-item",{attrs:{id:"1"}},[t._v("\n      营业未定\n    ")])],1),t._v(" "),a("div",{staticClass:"mui-content"},[t.list.length<=0?a("div",{staticClass:"rs-list-nodata"},[a("span",[t._v("无对应数据！")])]):t._e(),t._v(" "),a("rs-loadmore",{ref:"loadmore",attrs:{"bottom-method":t.doQueryNext,"top-status":t.topStatus,"bottom-all-loaded":t.allLoaded,"top-method":t.doQuery,"auto-fill":!1},on:{"update:topStatus":function(e){t.topStatus=e}}},[a("rs-list",{staticClass:"rr-line-24 rr-list-rili",attrs:{size:"14",noborder:""}},t._l(t.list,function(e){return a("rs-list-item",{key:e.BILLID,nativeOn:{click:function(a){t.linkBVSale(e)}}},[a("div",{staticClass:"rs-flex-row"},[a("div",{staticClass:"rr-media-rili"},[a("h3",[t._v(t._s(t._f("datePart")(e.SLDATE,"d")))]),t._v(" "),a("div",[t._v(t._s(t._f("datePart")(e.SLDATE,"m"))+"月")])]),t._v(" "),a("div",{staticClass:"rs-flex-item f17"},[a("span",{class:["rr-right f14",{"c-icon-red":["营业未订","息业已订"].indexOf(e.SLSTATENAME)>-1},{"c-icon-gray":["息业未订","期外未订"].indexOf(e.SLSTATENAME)>-1}]},[t._v(t._s(e.SLSTATENAME))]),t._v("\n                "+t._s(e.SNODECODE)+"\n              "),a("div",{staticClass:"mt10 f15"},[t._v("\n                "+t._s(e.SNODENAME)+"\n                "),a("div",{staticClass:"rr-right f14"},[e.AMT>0?a("span",[t._v(t._s(t._f("toFixed")(e.AMT,2))+"(元)")]):t._e()])])])])])})),t._v(" "),t.allLoaded?a("div",{staticClass:"rs-list-nodata"},[a("span",[t._v("没有数据啦")])]):t._e()],1)],1)],1)},staticRenderFns:[]};var E=a("C7Lr")(u,l,!1,function(t){a("E/ur")},"data-v-340d27c0",null);e.default=E.exports},sMse:function(t,e){},t1gn:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("4YfN"),r=a.n(s),n=a("vzcQ"),i={name:"bvsale_mat",props:{TITLE:""},data:function(){return{item:this.$route.params.item,number:[],MYQTY:""}},computed:r()({},Object(n.c)(["SELECTEDTAB"]),Object(n.b)("DTS",["MID.MNAME","MID.MCODE","MID.SIZETYPE","AMT","QTY","MINQTY","PRC"],"item")),methods:{up:function(){var t=this;this.$store.dispatch(n.a.STORE_NAME+"/upMat",this.item).then(function(e){e?t.item=e:t.$toast("没有了")})},down:function(){var t=this;this.$store.dispatch(n.a.STORE_NAME+"/downMat",this.item).then(function(e){e?t.item=e:t.$toast("没有了")})},navClick:function(t){var e=this.MYQTY+"";"C"==t?e=e.substring(0,e.length-1):e+=t,this.MYQTY=e,this.$store.commit(n.a.STORE_NAME+"/"+n.a.M_SETDTSQTY,{QTY:this.MYQTY,item:this.item})}},activated:function(){this.item=this.$route.params.item},watch:{item:{handler:function(){this.MYQTY=this.QTY},immediate:!0}},created:function(){for(var t=1;t<10;t++)this.number.push(t);this.number.push("."),this.number.push(0),this.number.push("C")}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("rs-view",{staticClass:"mui-layout mui-layout-top"},[a("rs-header",{attrs:{title:t.TITLE,color:"primary"}},[a("a",{staticClass:"mui-icon mui-icon-left-nav mui-pull-left",attrs:{slot:"left"},on:{click:function(e){t.$router.goBack()}},slot:"left"})]),t._v(" "),a("div",{staticClass:"mui-content"},[a("rs-list",{staticClass:"rr-line-24",attrs:{size:"15",noborder:""}},[a("rs-list-item",[t._v("\n        "+t._s(this["MID.MNAME"]+"("+this["MID.MCODE"]+")")+"\n      ")]),t._v(" "),a("rs-list-item",[a("div",{staticClass:"rs-flex-row"},[a("div",{staticClass:"rs-flex-item"},[a("span",{staticClass:"rr-justify rr-width-4em"},[t._v("规 格")]),t._v(" "),a("span",[t._v("：")]),t._v("\n            "+t._s(this["MID.SIZETYPE"])+"\n          ")]),t._v(" "),a("div",{staticClass:"rs-flex-item"},[a("span",{staticClass:"rr-justify rr-width-4em"},[t._v("单 位")]),t._v(" "),a("span",[t._v("：")]),t._v("\n            袋\n          ")])])]),t._v(" "),a("rs-list-item",[a("div",{staticClass:"rs-flex-row"},[a("div",{staticClass:"rs-flex-item"},[a("span",{staticClass:"rr-justify rr-width-4em"},[t._v("数 量")]),t._v(" "),a("span",[t._v("：")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.MYQTY,expression:"MYQTY"}],staticClass:"rr-width-4em rr-border rr-text-center",domProps:{value:t.MYQTY},on:{input:function(e){e.target.composing||(t.MYQTY=e.target.value)}}})]),t._v(" "),t.MINQTY>0?a("div",{staticClass:"rs-flex-item"},[a("span",{staticClass:"rr-justify rr-width-4em"},[t._v("最 小 订 货")]),t._v(" "),a("span",[t._v("：")]),t._v("\n            "+t._s(t.MINQTY)+"\n          ")]):t._e()])]),t._v(" "),a("rs-list-item",[a("div",{staticClass:"rs-flex-row"},[a("div",{staticClass:"rs-flex-item"},[a("span",{staticClass:"rr-justify rr-width-4em"},[t._v("单 价")]),t._v(" "),a("span",[t._v("：")]),t._v("\n            "+t._s(t.PRC)+"\n          ")]),t._v(" "),a("div",{staticClass:"rs-flex-item"},[a("span",{staticClass:"rr-justify rr-width-4em"},[t._v("金 额")]),t._v(" "),a("span",[t._v("：")]),t._v("\n            "+t._s(t._f("toFixed")(t.QTY*t.PRC,2))+"\n          ")])])])],1)],1),t._v(" "),a("div",{staticClass:"rr-number-key"},[a("rs-grid",{attrs:{type:"white",border:""}},t._l(t.number,function(e,s){return a("rs-grid-item",{key:s,nativeOn:{click:function(a){t.navClick(e)}}},[t._v("\n        "+t._s(e)+"\n      ")])}))],1),t._v(" "),a("div",{staticClass:"rs-flex-row rr-text-center rr-footer"},[a("div",{staticClass:"rs-flex-item",on:{click:t.up}},[a("span",{staticClass:"rr-font rr-iconleft f15"}),t._v(" 上一物料")]),t._v(" "),a("div",{staticClass:"rs-flex-item",on:{click:t.down}},[t._v("下一物料 "),a("span",{staticClass:"rr-font rr-iconright f15"})])])],1)},staticRenderFns:[]};var c=a("C7Lr")(i,o,!1,function(t){a("qeg8")},"data-v-08945f94",null);e.default=c.exports},vzcQ:function(t,e,a){"use strict";var s=a("lC5x"),r=a.n(s),n=a("J0Oq"),i=a.n(n),o=a("a3Yh"),c=a.n(o),u=a("4YfN"),l=a.n(u),E=a("aA9S"),D=a.n(E),T=a("IcnI"),d=a("9rMa"),S=a("rVsN"),I=a.n(S),p=a("+9g/");let f={};const A=function(t){f=t},v=async function({AID:t,AUID:e,BILLTYPEID:a,BUSTYPEID:s,BILLDATE:r,NOTYPEID:n}){return f.call({namespace:"GJ.EBZ.COM",class:"BusiCom",method:"GetBillCode",params:[t,e,n||"10205",a+"",s+""||"NULL",`to_date('${r}','yyyy-mm-dd')`,"0","0","0","0"]})},h=async function(){return f.postData({tp:"getdatetime"})},m=async function(){return f.postData({tp:"getdate"})},L=async function(t,e){var a={tp:"getid",modalName:t,col:e};return f.postData(a)};A(p.a);var _,M,O,N,P,C,g,b,Y,x,B,y,w,k,V=51494,U=51495,R=51498,Q=51499,j=51509,$=51500,H=51510,F=(_=i()(r.a.mark(function t(e){var a=e.BILLDATE,s=e.SNODEID,n=e.BILLID,i=e.BILLTYPEID,o=e.BUSTYPEID;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",p.a.open({sqlId:V,BILLDATE:a,SNODEID:s,BILLID:n,BILLTYPEID:i,BUSTYPEID:o}));case 1:case"end":return t.stop()}},t,this)})),function(t){return _.apply(this,arguments)}),G=(M=i()(r.a.mark(function t(e){var a=e.BILLID;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",p.a.open({sqlId:H,BILLID:a}));case 1:case"end":return t.stop()}},t,this)})),function(t){return M.apply(this,arguments)}),q=(O=i()(r.a.mark(function t(e){var a=e.BILLTYPEID,s=e.BUSTYPEID;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",p.a.open({modalName:"VBS_SALETYPE_4ZCC",where:"[BUSTYPEID] ='"+s+"' AND [BILLTYPEID] = '"+a+"' AND AID=@AID AND ISUSE = 1 AND ISVERIFY = 1 AND NVL(ISDEL,0) = 0",orderBy:"",pageSize:1,pageIndex:1}));case 1:case"end":return t.stop()}},t,this)})),function(t){return O.apply(this,arguments)}),K=(N=i()(r.a.mark(function t(e){var a,s=e.PTYPE,n=e.BILLDATE;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a={namespace:"GJ.EBZ.BS",class:"Period",method:"GetCheckPeriod",params:[{periodTypeID:s,date:n,accountType:"ISCHECKOUT4"}],ISCHECKREPEAT:!0},t.abrupt("return",p.a.call(a).then(function(t){return new I.a(function(e,a){t.data.ERRORCODE<0?a(new Error(t.data.ERRORTXT)):e(t)})}));case 3:case"end":return t.stop()}},t,this)})),function(t){return N.apply(this,arguments)}),X=(P=i()(r.a.mark(function t(e){var a=e.SNODEID;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",p.a.open({modalName:"VBS_SNODE",where:"[SNODEID] ='"+a+"'",orderBy:"",pageSize:1,pageIndex:1}));case 1:case"end":return t.stop()}},t,this)})),function(t){return P.apply(this,arguments)}),z=(C=i()(r.a.mark(function t(e){var a=e.CUSTID;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",p.a.open({sqlId:$,CUSTID:a}));case 1:case"end":return t.stop()}},t,this)})),function(t){return C.apply(this,arguments)}),W=(g=i()(r.a.mark(function t(e){var a=e.BILLDATE,s=e.SNODEID,n=e.WEEK;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",p.a.open({sqlId:U,BILLDATE:a,SNODEID:s,WEEK:n}));case 1:case"end":return t.stop()}},t,this)})),function(t){return g.apply(this,arguments)}),J=(b=i()(r.a.mark(function t(e){var a=e.BILLDATE,s=e.SNODEID;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",p.a.open({sqlId:R,BILLDATE:a,SNODEID:s}));case 1:case"end":return t.stop()}},t,this)})),function(t){return b.apply(this,arguments)}),Z=(Y=i()(r.a.mark(function t(e){var a=e.SALEPLCID;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",p.a.open({modalName:"VSL_MATERIAL_SEL_4BVSALE",where:"[SALEPLCID] ='"+a+"' AND [TAG]=1",orderBy:"[MID.MBRULECODE],[MID.MLORDERCODE],[MID.FMCODE],[MID.MTORDERCODE],[MID.ORDERCODE],[MID.MCODE]",pageSize:1,pageIndex:1}));case 1:case"end":return t.stop()}},t,this)})),function(t){return Y.apply(this,arguments)}),tt=(x=i()(r.a.mark(function t(e){var a=e.DISTID,s=e.SNODEID,n=e.BILLDATE,i=e.MNGTYPEID;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",p.a.open({sqlId:Q,DISTID:a,SNODEID:s,BILLDATE:n,MNGTYPEID:i}));case 1:case"end":return t.stop()}},t,this)})),function(t){return x.apply(this,arguments)}),et=(B=i()(r.a.mark(function t(e){var a=e.SALEPLCID;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",p.a.open({sqlId:j,SALEPLCID:a}));case 1:case"end":return t.stop()}},t,this)})),function(t){return B.apply(this,arguments)}),at=(y=i()(r.a.mark(function t(e){var a,s,n=e.saveTables,i=e.BILLID;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return(a={EXETYPE:"Save"}).BILLID=i,s={namespace:"GJ.EBZ.SL",class:"Sale",method:"BVSaleExecute",params:[a,n],ISCHECKREPEAT:!0},t.abrupt("return",p.a.call(s).then(function(t){}));case 4:case"end":return t.stop()}},t,this)})),function(t){return y.apply(this,arguments)}),st=(w=i()(r.a.mark(function t(e){var a,s,n=e.saveTables,i=e.BILLID;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return(a={EXETYPE:"Delete"}).BILLID=i,s={namespace:"GJ.EBZ.SL",class:"Sale",method:"BVSaleExecute",params:[a,n],ISCHECKREPEAT:!0},t.abrupt("return",p.a.call(s).then(function(t){}));case 4:case"end":return t.stop()}},t,this)})),function(t){return w.apply(this,arguments)}),rt={doGetBillCode:v,doGetDate:m,doGetDateTime:h,doGetNewID:L,doCheckIsOrder:F,doQueryOrderStatus:G,doQueryBusType:q,doGetPeriod:K,doQuerySnode:X,doQueryCust:z,doCheckXiYe:W,doQuerySalePlc:J,doQuerySalePlcDts:Z,doQueryAMTLMT:tt,doQueryMINQTY:et,doOpen:(k=i()(r.a.mark(function t(e){var a=e.MAIN,s=e.DTS,n=e.DID;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",p.a.openTables([{path:a.path,para:{where:"[BILLID]="+n,scmName:a.scm}},{path:s.path,para:{where:"[BILLID]="+n,scmName:s.scm}}]));case 1:case"end":return t.stop()}},t,this)})),function(t){return k.apply(this,arguments)}),doSave:at,doDelete:st},nt=a("XUaV");const it={M_INITDATA:"initData",M_CLEARDATA:"clearData",M_INITBYPATH:"initByPath",M_BATCHSETDATA:"batchSetData",M_SETVALUE:"setValue",M_SETPARAMS:"setParams",STORE_NAME:"STORE_NAME",DT:"dt"};class ot{constructor(t){this.name=t.STORE_NAME,this.dt={},this.paths=t.paths,this.service=t.service}getTable(t){return this[it.DT][t]}mixState(){let t={};return this.paths&&Object.keys(this.paths).forEach(e=>{t[e]=new nt.a(e,this.paths[e])}),this.dt=t,{dt:t}}mixActions(){return{}}mixMutations(){let t=this;return{[it.M_INITDATA]:function(t,{path:e,data:a}){t[it.DT][e].initData(a)},[it.M_CLEARDATA]:function(t,{path:e}){t[it.DT][e].clear(data)},[it.M_SETVALUE]:function(t,{path:e,field:a,value:s,idx:r}){t[it.DT][e].setValue(a,s,r)},[it.M_SETPARAMS]:function(t,e){t.params=e},[it.M_INITBYPATH]:function(e,{paths:a}){a.forEach(e=>{t.getTable(e)&&t.getTable(e).initData()})},[it.M_BATCHSETDATA]:function(e,{data:a}){Object.keys(a).forEach(s=>{t.getTable(s)?t.getTable(s).setData(a[s].items):e[s]=a[s]})}}}mapGetters(t,e,a){let s=this.dt[t];e=e||[],s.bindField(e);let r={};for(let t,n=0;n<e.length;n++)r[t=e[n]]={get(){return s.getValue(t.replace(/_/g,"."),a?this[a]:0)},set(e){s.setValue(t.replace(/_/g,"."),e,a?this[a]:0)}};return r[t]=function(){return s.data},r}}const ct=Object.assign({},it,{});var ut,lt=a("JIbx"),Et=a("aP4p"),Dt=a("Et8i");a.d(e,"c",function(){return It}),a.d(e,"b",function(){return _t}),a.d(e,"a",function(){return dt});var Tt,dt=D()({},ct,{STORE_NAME:"bvsale",M_ADDDEFAULT:"addDefault",M_SETBUSTYPE:"setBusType",M_SETSNODE:"setSnode",M_SETSNODEXY:"setSnodeXY",M_SETSALEPLC:"setSalePlc",M_SETAMTLMT:"setAMTLMT",M_SETMINQTY:"setMinQty",M_SETCUST:"setCust",M_SETPERIOD:"setPeriod",M_ADDDTS:"addDTS",M_SETMAINKEY:"setMainKey",M_SETDTSKEY:"setDtsKey",M_SETMAKEINFO:"setMakeInfo",M_SETDTSQTY:"setDtsQty",M_SETSELECTED:"setSelected",M_SETBILLCODE:"setBillCode",M_SETSTATE:"setState",P_PATHS:{MAIN:"MAIN",DTS:"DTS",MAT:"MAT",AMTLMT:"AMTLMT"}}),St=Object(d.a)(dt.STORE_NAME),It=(St.mapState,St.mapGetters),pt=new class extends ot{constructor(t){super(t)}mixState(){return super.mixState()}mixActions(){return super.mixActions()}mixMutations(){return super.mixMutations()}}({paths:{MAIN:"TSL_SALE_4MOBILE",DTS:"TSL_SALEDTSPC",SALEDTS:"TSL_SALEDTS",SALEDTSF:"TSL_SALEDTSF",MAT:"VSL_MATERIAL_SEL_4BVSALE",AMTLMT:""}}),ft=l()({params:{ACTION:"",BILLTYPEID:""},SELECTED:"1",OQTY:{},PLCMID:{},STATE:""},pt.mixState()),At={ISSHOWSAVE:function(t,e,a,s){var r=pt.getTable(dt.P_PATHS.MAIN);return"1"!=r.getValue("ISTALLY")&&1==r.count()&&100993==r.getValue("BUSTYPEID")&&s.pcode["salemanage.add"]},ISSHOWDELETE:function(t,e,a,s){var r=pt.getTable(dt.P_PATHS.MAIN);return"1"!=r.getValue("ISTALLY")&&1==r.count()&&100993==r.getValue("BUSTYPEID")&&!r.isAdd()&&s.pcode["salemanage.delete"]},DTSMESSAGE:function(){var t=pt.getTable(dt.P_PATHS.MAIN),e=t.getValue("SNODEID.SDATE"),a=t.getValue("SNODEID.EDATE"),s=t.getValue("SNODEID.ISXY"),r=t.getValue("BILLDATE"),n=t.getValue("SNODEID");return"Loading"==ft.STATE?"":n?r&&(r<e||r>a)?"该网点,超经营期限。请与相关人员联系！":"1"==s?"该网点,息业，请与相关人员联系！":t.getValue("SALEPLCID")?"":"该网点,无订货政策，请与相关人员联系！":"请选择经营网点！"},DTSITEMS:function(t){return pt.getTable(dt.P_PATHS.DTS).data.filter(function(e){return"1"==t.SELECTED||("2"==t.SELECTED?e.QTY>0:"3"==t.SELECTED?e.QTY<=0:void 0)})},ISMODIFY:function(t){var e=pt.getTable(dt.P_PATHS.DTS),a=pt.getTable(dt.P_PATHS.DTS);return e.isModify()||a.isModify()}},vt=l()({},pt.mixMutations(),(ut={},c()(ut,dt.M_ADDDEFAULT,function(t){var e={},a=t.params.SNODEID||this.getters.userInfo.SNODEID,s=t.params.BILLDATE||Object(lt.c)(Object(lt.a)(new Date,"d",1));e.OBJTYPEID=9021,e.SNODEID=a,e.BILLDATE=s,e.BUSTYPEID=100993,e.BILLTYPEID=232,e.STATE=9937,e.FACID=0,pt.getTable("MAIN").add(e)}),c()(ut,dt.M_SETBUSTYPE,function(t,e){var a=e.item,s=pt.getTable(dt.P_PATHS.MAIN);s.setValue("MSTYPEID",a.MSTYPEID),s.setValue("SALETYPEID",a.SALETYPEID),s.setValue("ISCBYFEE",a.ISCBYFEE),s.setValue("CBYFEE",a.CBYFEE),s.setValue("LADTYPEID",a.LADTYPEID),s.setValue("DLVTYPEID",a.DLVTYPEID)}),c()(ut,dt.M_SETSNODE,function(t,e){var a=e.item,s=pt.getTable(dt.P_PATHS.MAIN);s.setValue("SNODEID",a.SNODEID),s.setValue("SNODEID.SNODECODE",a.SNODECODE),s.setValue("SNODEID.SNODENAME",a.SNODENAME),s.setValue("SNODEID.SDATE",a.SDATE),s.setValue("SNODEID.EDATE",a.EDATE),s.setValue("DEPTID",a.DEPTID),s.setValue("EMPID",a.EMPID),s.setValue("RPSTID",a.RPSTID),s.setValue("CUSTID",a.CUSTID),s.setValue("SNODEID.DISTID",a.DISTID),s.setValue("SNODEID.MNGTYPEID",a.MNGTYPEID),s.setValue("MNGTYPEID",a.MNGTYPEID),s.setValue("INVTYPEID",a.INVTYPEID),s.setValue("STLTYPEID",a.STLTYPEID)}),c()(ut,dt.M_SETSNODEXY,function(t,e){var a=e.data,s=pt.getTable(dt.P_PATHS.MAIN);a=a||[],s.setValue("SNODEID.ISXY",a.length>0?"1":"0")}),c()(ut,dt.M_SETCUST,function(t,e){var a=e.item,s=pt.getTable(dt.P_PATHS.MAIN);s.setValue("INVTYPEID",a.INVTYPEID||""),s.setValue("STLTYPEID",a.STLTYPEID||"")}),c()(ut,dt.M_SETSALEPLC,function(t,e){var a=e.item;pt.getTable(dt.P_PATHS.MAIN).setValue("SALEPLCID",a.SALEPLCID||"")}),c()(ut,dt.M_SETAMTLMT,function(t,e){var a=e.data,s=pt.getTable(dt.P_PATHS.MAIN),r=0;a.length>0&&(r=Object(Et.c)(a[0].MINAMT)?a[0].MINAMT:0),s.setValue("MINAMT",r)}),c()(ut,dt.M_SETMINQTY,function(t,e){var a=e.data;t.PLCMID={},a.forEach(function(e){t.PLCMID[e.MID]=e.MINQTY})}),c()(ut,dt.M_ADDDTS,function(t){var e=pt.getTable(dt.P_PATHS.DTS),a=pt.getTable(dt.P_PATHS.MAT);t.OQTY={},e.data.forEach(function(e){t.OQTY[e.MID]=e.QTY}),e.clear(),a.data.forEach(function(a,s){var r={};r.MID=a.MID,r.BILLID=a.BILLID,r.ENTRYNUM=s+1,r["MID.MCODE"]=a["MID.MCODE"],r.PRC=a.PRC,r.AMT="",r.TAXRATE=a.TAXRATE,r.QTY=t.OQTY[a.MID]||"",r.MINQTY=t.PLCMID[a.MID]||"",r["MID.MNAME"]=a["MID.MNAME"],r["MID.SIZETYPE"]=a["MID.SIZETYPE"],r.UNITID=a["MID.SUNITID"],r["MID.UNITNAME"]=a["MID.SUNITNAME"],r["MID.UNITRATE"]=a["MID.SUNITRATE"],r["MID.SUNITRATE"]=a["MID.SUNITRATE"],r["MID.UUNITRATE"]=a["MID.UUNITRATE"],r["MID.SUNITNAME"]=a["MID.SUNITNAME"],r["MID.UUNITNAME"]=a["MID.UUNITNAME"],r["MID.MUNITNAME"]=a["MID.MUNITNAME"],r["MID.SQTYPREC"]=a["MID.SQTYPREC"],r["MID.MQTYPREC"]=a["MID.MQTYPREC"],e.add(r)})}),c()(ut,dt.M_SETPERIOD,function(t,e){var a=e.PTYPE,s=e.VALUE,r=s.PYEAR||"",n=s.PMONTH||"",i=pt.getTable(dt.P_PATHS.MAIN);i.setValue(192==a?"FYEAR":"PYEAR",r),i.setValue(192==a?"FMONTH":"PMONTH",n)}),c()(ut,dt.M_SETMAINKEY,function(t,e){var a=e.data,s=pt.getTable(dt.P_PATHS.MAIN),r=pt.getTable(dt.P_PATHS.DTS);s.setValue("BILLID",a),r.data.forEach(function(t){r.setValue("BILLID",a,t)})}),c()(ut,dt.M_SETDTSKEY,function(t,e){var a=e.data,s=pt.getTable(dt.P_PATHS.DTS).data.filter(function(t){t.ENTRYID});a=parseFloat(a),s.forEach(function(t,e){t.ENTRYID=a-s.length+1+e})}),c()(ut,dt.M_SETMAKEINFO,function(t,e){var a=e.data,s=pt.getTable(dt.P_PATHS.MAIN);s.setValue("MAKEDATE",a),s.setValue("MAKERID",this.getters.userInfo.AUID)}),c()(ut,dt.M_SETDTSQTY,function(t,e){var a=e.QTY,s=e.item,r=pt.getTable(dt.P_PATHS.MAIN),n=pt.getTable(dt.P_PATHS.DTS),i=s["MID.SUNITRATE"],o=s["MID.UUNITRATE"],c=(s["MID.SUNITNAME"],s["MID.UUNITNAME"]),u=s["MID.MUNITNAME"],l=~~s["MID.SQTYPREC"],E=~~s["MID.MQTYPREC"],D=Object(Et.d)(s.PRC);a=Object(Et.d)(a);var T=(a=Math.round(a*Math.pow(10,l))/Math.pow(10,l))*i;parseInt(T,10)!=parseFloat(T)&&(a=0),n.setValue("QTY",a||"",s),n.setValue("AMT",parseFloat((a*D).toFixed(2)),s);var d=ht(a,i,o,c,u,E);n.setValue("UQTY",d,s);var S=0;n.data.forEach(function(t){S+=Object(Et.d)(t.PRC*t.QTY)}),r.setValue("AMT",S)}),c()(ut,dt.M_SETSELECTED,function(t,e){t.SELECTED=e}),c()(ut,dt.M_SETBILLCODE,function(t,e){var a=e.data;pt.getTable(dt.P_PATHS.MAIN).setValue("BILLCODE",a)}),c()(ut,dt.M_SETSTATE,function(t,e){t.STATE=e}),ut)),ht=function(t,e,a,s,r,n){var i=0,o=0;return t=Object(Et.b)(t)||isNaN(t)?0:t,e=Object(Et.b)(e)||isNaN(e)?0:e,a=Object(Et.b)(a)||isNaN(a)?0:a,s=Object(Et.b)(s)?"":s,r=Object(Et.b)(r)?"":r,n=Object(Et.b)(n)||isNaN(n)?0:n,1==e&&1==a?0==t?"":t+s:(0!=~~e&&0!=~~a&&(i=Math.abs(parseInt(t*e/a),10),o=this.DealWithQTYPREC(Math.abs(t*e)-i*a,n)),(t>=0?"":"-")+(0==i?"":i+s)+(0==o?"":o+r))},mt=(Tt=i()(r.a.mark(function t(){var e,a,s,n,i,o,c,u,l,E,D;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=pt.getTable(dt.P_PATHS.MAIN),a=pt.getTable(dt.P_PATHS.DTS),s=[],n=[],e.getValue("SNODEID")||s.push("经营网点"),e.getValue("BILLDATE")||s.push("单据日期"),s.length>0&&n.push(s+" 空"),!(n.length>0)){t.next=9;break}throw new Error(n.join("\n")+"，不可保存");case 9:return 0==a.data.filter(function(t){return t.QTY>0})&&n.push("没有具体订货"),a.data.find(function(t){return Object(Et.d)(t.MINQTY)>Object(Et.d)(t.QTY)})&&n.push("最小订量,未满足"),Object(Et.d)(e.getValue("AMT"))<Object(Et.d)(e.getValue("MINAMT"))&&n.push("订货金额<最小金额"),i=e.getValue("BILLDATE"),t.next=15,rt.doGetDate();case 15:if(o=t.sent.data,c=Object(lt.c)(Object(lt.a)(Object(lt.f)(o),"d",1)),u=Object(lt.c)(Object(lt.a)(Object(lt.f)(o),"d",10)),i<c&&n.push("订货日期<当前日期+1"),i>u&&n.push("订货日期>当前日期+10"),l=e.getValue("SNODEID.SDATE"),E=e.getValue("SNODEID.EDATE"),i&&(i<l||i>E)&&n.push("该网点,超经营期限"),!(n.length>0)){t.next=25;break}throw new Error(n.join("\n")+"，不可保存");case 25:if(e.isAdd()){t.next=32;break}return t.next=28,rt.doQueryOrderStatus({BILLID:e.getValue("BILLID")});case 28:if(0==(D=t.sent).data.items.length?n.push("已删除"):1==D.data.items[0].ISTALLY&&n.push("已审核"),!(n.length>0)){t.next=32;break}throw new Error(n.join("\n")+"，不可保存");case 32:return t.next=34,rt.doCheckIsOrder({BILLID:e.getValue("BILLID"),BILLTYPEID:e.getValue("BILLTYPEID"),BUSTYPEID:e.getValue("BUSTYPEID"),BILLDATE:i,SNODEID:e.getValue("SNODEID")});case 34:if(t.sent.data.items.length>0&&n.push("对应日期,已有订货"),!(n.length>0)){t.next=38;break}throw new Error(n.join("\n")+"，不可保存");case 38:case"end":return t.stop()}},t,this)})),function(){return Tt.apply(this,arguments)}),Lt=l()({},pt.mixActions(),{add:function(t){var e=this,a=t.commit,s=(t.state,t.dispatch);return i()(r.a.mark(function t(){var n,i,o,c,u,l;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a(dt.M_SETSTATE,"Loading"),a(dt.M_SETSELECTED,"1"),a(dt.M_INITBYPATH,{paths:[dt.P_PATHS.MAIN,dt.P_PATHS.DTS]}),a(dt.M_ADDDEFAULT),n=pt.getTable(dt.P_PATHS.MAIN),i=n.getValue("SNODEID"),o=n.getValue("BILLDATE"),t.next=9,rt.doCheckIsOrder({SNODEID:i,BILLDATE:o,BILLTYPEID:n.getValue("BILLTYPEID"),BUSTYPEID:n.getValue("BUSTYPEID")});case 9:if(1!=(c=t.sent).data.items.length){t.next=13;break}return s("open",c.data.items[0].BILLID),t.abrupt("return");case 13:return t.next=15,rt.doQueryBusType({BILLTYPEID:n.getValue("BILLTYPEID"),BUSTYPEID:n.getValue("BUSTYPEID")});case 15:if(c=t.sent,a(dt.M_SETBUSTYPE,{item:c.data.items[0]||{}}),u={},!i){t.next=46;break}return t.next=21,rt.doQuerySnode({SNODEID:i});case 21:return c=t.sent,u=c.data.items[0]||{},a(dt.M_SETSNODE,{item:u}),l=0==(l=Object(lt.f)(o)).getDay()?7:l.getDay(),t.next=28,rt.doCheckXiYe({SNODEID:i,BILLDATE:o,WEEK:l});case 28:return c=t.sent,a(dt.M_SETSNODEXY,{data:c.data.items||[]}),t.next=32,rt.doQueryCust({CUSTID:n.getValue("CUSTID")});case 32:return c=t.sent,a(dt.M_SETCUST,{item:c.data.items[0]||{}}),t.next=36,rt.doQuerySalePlc({BILLDATE:o,SNODEID:i});case 36:if(c=t.sent,a(dt.M_SETSALEPLC,{item:c.data.items[0]||{}}),!n.getValue("SALEPLCID")){t.next=44;break}return t.next=42,s("changeSalePlc");case 42:t.next=44;break;case 44:t.next=46;break;case 46:if(!o){t.next=55;break}return t.next=49,rt.doGetPeriod({PTYPE:"191",BILLDATE:o});case 49:return c=t.sent,a(dt.M_SETPERIOD,{PTYPE:191,VALUE:c.data.VALUE||{}}),t.next=53,rt.doGetPeriod({PTYPE:"192",BILLDATE:o});case 53:c=t.sent,a(dt.M_SETPERIOD,{PTYPE:192,VALUE:c.data.VALUE||{}});case 55:a(dt.M_SETSTATE,"Add");case 56:case"end":return t.stop()}},t,e)}))()},changeSnode:function(t,e){var a=this,s=t.commit,n=t.dispatch,o=e.item;return i()(r.a.mark(function t(){var e,i,c,u,l,E;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=pt.getTable(dt.P_PATHS.MAIN),s(dt.M_SETSNODE,{item:o}),i=e.getValue("SNODEID"),c=e.getValue("BILLDATE"),t.next=6,rt.doCheckIsOrder({SNODEID:i,BILLDATE:c,BILLTYPEID:e.getValue("BILLTYPEID"),BUSTYPEID:e.getValue("BUSTYPEID")});case 6:if(1!=(u=t.sent).data.items.length){t.next=10;break}return n("open",u.data.items[0].BILLID),t.abrupt("return");case 10:return l=0==(l=Object(lt.f)(c)).getDay()?7:l.getDay(),t.next=14,rt.doCheckXiYe({SNODEID:i,BILLDATE:c,WEEK:l});case 14:return u=t.sent,s(dt.M_SETSNODEXY,{data:u.data.items||[]}),t.next=18,rt.doQueryCust({CUSTID:e.getValue("CUSTID")});case 18:return u=t.sent,s(dt.M_SETCUST,{item:u.data.items[0]||{}}),E=e.getValue("SALEPLCID"),t.next=23,rt.doQuerySalePlc({BILLDATE:c,SNODEID:i});case 23:if(u=t.sent,s(dt.M_SETSALEPLC,{item:u.data.items[0]||{}}),e.getValue("SALEPLCID")==E){t.next=29;break}return t.next=29,n("changeSalePlc");case 29:case"end":return t.stop()}},t,a)}))()},changeBillDate:function(t){var e=this,a=t.commit,s=t.dispatch;return i()(r.a.mark(function t(){var n,i,o,c,u;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=pt.getTable(dt.P_PATHS.MAIN),i=n.getValue("SNODEID"),o=n.getValue("BILLDATE"),c=n.getValue("SALEPLCID"),t.next=6,rt.doCheckIsOrder({SNODEID:i,BILLDATE:o,BILLTYPEID:n.getValue("BILLTYPEID"),BUSTYPEID:n.getValue("BUSTYPEID")});case 6:if(1!=(u=t.sent).data.items.length){t.next=10;break}return s("open",u.data.items[0].BILLID),t.abrupt("return");case 10:return t.next=12,rt.doQuerySalePlc({BILLDATE:o,SNODEID:i});case 12:if(u=t.sent,a(dt.M_SETSALEPLC,{item:u.data.items[0]||{}}),n.getValue("SALEPLCID")==c){t.next=18;break}return t.next=18,s("changeSalePlc");case 18:return t.next=20,rt.doGetPeriod({PTYPE:"191",BILLDATE:o});case 20:return u=t.sent,a(dt.M_SETPERIOD,{PTYPE:191,VALUE:u.data.VALUE||{}}),t.next=24,rt.doGetPeriod({PTYPE:"192",BILLDATE:o});case 24:u=t.sent,a(dt.M_SETPERIOD,{PTYPE:192,VALUE:u.data.VALUE||{}});case 26:case"end":return t.stop()}},t,e)}))()},changeSalePlc:function(t){var e=this,a=t.commit;return i()(r.a.mark(function t(){var s,n,i;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s=pt.getTable(dt.P_PATHS.MAIN),n=s.getValue("SALEPLCID"),t.next=4,rt.doQuerySalePlcDts({SALEPLCID:n});case 4:return i=t.sent,a(dt.M_INITDATA,{path:dt.P_PATHS.MAT,data:(i.data||{}).items}),t.next=8,rt.doQueryAMTLMT({DISTID:s.getValue("SNODEID.DISTID"),SNODEID:s.getValue("SNODEID"),BILLDATE:s.getValue("BILLDATE"),MNGTYPEID:s.getValue("MNGTYPEID")});case 8:return i=t.sent,a(dt.M_SETAMTLMT,{data:(i.data||{}).items}),t.next=12,rt.doQueryMINQTY({SALEPLCID:n});case 12:i=t.sent,a(dt.M_SETMINQTY,{data:(i.data||{}).items}),a(dt.M_ADDDTS);case 15:case"end":return t.stop()}},t,e)}))()},open:function(t,e){var a=this,s=t.commit;return i()(r.a.mark(function t(){var n,i,o;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s(dt.M_SETSTATE,"Loading"),s(dt.M_SETSELECTED,"2"),n=pt.getTable(dt.P_PATHS.MAIN),i=pt.getTable(dt.P_PATHS.DTS),t.next=6,rt.doOpen({MAIN:n,DTS:i,DID:e});case 6:o=t.sent,s(dt.M_BATCHSETDATA,{data:o.data||{}}),s(dt.M_SETSTATE,"VIEW");case 9:case"end":return t.stop()}},t,a)}))()},_beforeSave:function(t){var e=this,a=t.commit;return i()(r.a.mark(function t(){var s,n,i,o,c,u,l;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s=pt.getTable(dt.P_PATHS.MAIN),n=pt.getTable(dt.P_PATHS.DTS),t.next=4,Object(Dt.a)(mt);case 4:if(s.getValue("BILLCODE")){t.next=13;break}return t.next=7,rt.doGetBillCode({AID:e.getters.userInfo.AID,AUID:e.getters.userInfo.AUID,BILLTYPEID:s.getValue("BILLTYPEID"),BUSTYPEID:s.getValue("BUSTYPEID"),BILLDATE:s.getValue("BILLDATE")});case 7:if((i=t.sent).data){t.next=12;break}throw new Error("单号获取失败！");case 12:a(dt.M_SETBILLCODE,{data:i.data});case 13:if(s.getValue("BILLID")){t.next=20;break}return t.next=16,rt.doGetNewID(s.scm,1);case 16:o=t.sent,a(dt.M_SETMAINKEY,{data:o.did}),t.next=21;break;case 20:a(dt.M_SETMAINKEY,{data:s.getValue("BILLID")});case 21:if(!((c=n.data.filter(function(t){return!t.ENTRYID}).length)>0)){t.next=27;break}return t.next=25,rt.doGetNewID(n.scm,c);case 25:u=t.sent,a(dt.M_SETDTSKEY,{data:u.did});case 27:return t.next=29,rt.doGetDateTime();case 29:l=t.sent,a(dt.M_SETMAKEINFO,{data:l.data});case 31:case"end":return t.stop()}},t,e)}))()},save:function(t){var e=this,a=t.dispatch;return i()(r.a.mark(function t(){var s,n,i;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a("_beforeSave");case 2:return s={},n=pt.getTable(dt.P_PATHS.MAIN),i=pt.getTable(dt.P_PATHS.DTS),s.SALE=n.getXML(),s.SALEDTSPC=i.getXML(),s.SALEDTS=pt.getTable("SALEDTS").getXML(),s.SALEDTSF=pt.getTable("SALEDTSF").getXML(),t.next=11,rt.doSave({saveTables:s,BILLID:n.getValue("BILLID")});case 11:case"end":return t.stop()}},t,e)}))()},delete:function(){var t=this;return i()(r.a.mark(function e(){var a,s,n,i;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a={},s=pt.getTable(dt.P_PATHS.MAIN),n=pt.getTable(dt.P_PATHS.DTS),i=s.getValue("BILLID"),s.clear(),n.clear(),a.SALE=s.getXML(),a.SALEDTSPC=n.getXML(),a.SALEDTS=pt.getTable("SALEDTS").getXML(),a.SALEDTSF=pt.getTable("SALEDTSF").getXML(),t.next=12,rt.doDelete({saveTables:a,BILLID:i});case 12:case"end":return t.stop()}},e,t)}))()},upMat:function(t,e){t.commit,t.state;var a=t.getters,s=(pt.getTable(dt.P_PATHS.DTS),-2),r=a.DTSITEMS;return r.forEach(function(t,a){t.MID==e.MID&&(s=a)}),r[s-1]},downMat:function(t,e){t.commit;var a=t.getters,s=pt.getTable(dt.P_PATHS.DTS),r=-2;return a.DTSITEMS.forEach(function(t,a){t.MID==e.MID&&(r=a)}),s.data[r+1]}});T.a.registerModule(dt.STORE_NAME,{namespaced:!0,state:ft,getters:At,mutations:vt,actions:Lt});var _t=function(t,e,a){return pt.mapGetters(t,e,a)}},x4ez:function(t,e){},xIW9:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("lC5x"),r=a.n(s),n=a("J0Oq"),i=a.n(n),o=a("4YfN"),c=a.n(o),u=a("vzcQ"),l={name:"bvsale",props:{TITLE:{default:"订货单"}},data:function(){return{}},computed:c()({},Object(u.c)(["ISSHOWSAVE","ISSHOWDELETE","DTSMESSAGE","DTSITEMS","ISMODIFY"]),Object(u.b)("MAIN",["SALEPLCID","SNODEID","BILLTYPEID","BILLDATE","BILLCODE","SNODEID.SNODECODE","SNODEID.SNODENAME","AMT"]),Object(u.b)("DTS",[])),methods:{linkUrl:function(t){this.$router.push({path:"/bvsale/add/"+t})},linkMat:function(t){this.$router.push({name:"/bvsale/add/mat",params:{item:t}})},open:function(t){this.$refs[t].open()},handleChangeD:function(){this.$callAction({action:u.a.STORE_NAME+"/changeBillDate"})},save:function(){this.$callAction({action:u.a.STORE_NAME+"/save",successText:"保存成功",isSuccessBack:!0})},del:function(){var t=this;return i()(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$confirm("确认删除？");case 2:t.$callAction({action:u.a.STORE_NAME+"/delete",successText:"删除成功",isSuccessBack:!0});case 3:case"end":return e.stop()}},e,t)}))()}},activated:function(){console.log("%c"+this.$route.path,"color:red")},created:function(){console.log("%c创建了一次","color:red")},beforeRouteLeave:function(t,e,a){var s=this;return i()(r.a.mark(function n(){return r.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(t.matched[0]!==e.matched[0]&&s.ISMODIFY&&!s.$router.isForce){r.next=4;break}return s.$router.isForce=!1,a(),r.abrupt("return");case 4:s.$confirm("确认不保存修改直接离开么？").then(function(){a()}).catch(function(t){a(!1)});case 5:case"end":return r.stop()}},n,s)}))()}},E={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("rs-view",{staticClass:"mui-layout mui-layout-top"},[a("rs-header",{attrs:{title:t.TITLE,color:"primary"}},[a("a",{staticClass:"mui-icon mui-icon-left-nav mui-pull-left",attrs:{slot:"left"},on:{click:function(e){t.$router.goBack()}},slot:"left"}),t._v(" "),a("div",{attrs:{slot:"right"},slot:"right"},[t.ISSHOWDELETE?a("rs-button",{attrs:{link:""},on:{click:t.del}},[t._v("删除")]):t._e(),t._v(" "),t.ISSHOWSAVE?a("rs-button",{attrs:{link:""},on:{click:t.save}},[t._v("保存")]):t._e()],1)]),t._v(" "),a("rs-list",{staticClass:"rr-line-24",attrs:{size:"15",noborder:""}},[""!=t.BILLCODE?a("rs-list-item",[a("div",{staticClass:"rs-flex-row"},[a("span",{staticClass:"rr-justify rr-width-4em"},[t._v("订 货 单 号")]),t._v(" "),a("span",[t._v("：")]),t._v(" "),a("div",{staticClass:"rs-flex-item"},[t._v("\n            "+t._s(t.BILLCODE)+"\n        ")])])]):t._e(),t._v(" "),a("rs-list-item",{attrs:{isright:""},nativeOn:{click:function(e){t.open("picker1")}}},[a("div",{staticClass:"rs-flex-row"},[a("span",{staticClass:"rr-justify rr-width-4em"},[t._v("订 货 日 期")]),t._v(" "),a("span",[t._v("：")]),t._v(" "),a("div",{staticClass:"rs-flex-item"},[t._v("\n            "+t._s(t._f("getWeek")(t.BILLDATE))+"\n        ")])])]),t._v(" "),a("rs-list-item",{attrs:{noborder:"",isright:""},nativeOn:{click:function(e){t.linkUrl("jsnodesel")}}},[a("div",{staticClass:"rs-flex-row"},[a("span",{staticClass:"rr-justify rr-width-4em"},[t._v("经 营 门 店")]),t._v(" "),a("span",[t._v("：")]),t._v(" "),a("div",{staticClass:"rs-flex-item"},[t._v("\n              "+t._s(this["SNODEID.SNODECODE"])+" "+t._s(this["SNODEID.SNODENAME"])+"\n        ")])])])],1),t._v(" "),a("rs-datetime",{key:"bvsale.1",ref:"picker1",attrs:{type:"date"},on:{confirm:t.handleChangeD},model:{value:t.BILLDATE,callback:function(e){t.BILLDATE=e},expression:"BILLDATE"}}),t._v(" "),a("rs-navbar",{attrs:{inverted:""},model:{value:t.$store.state.bvsale.SELECTED,callback:function(e){t.$set(t.$store.state.bvsale,"SELECTED",e)},expression:"$store.state.bvsale.SELECTED"}},[a("rs-nav-item",{attrs:{id:"1"}},[t._v("\n      全部\n    ")]),t._v(" "),a("rs-nav-item",{attrs:{id:"2"}},[t._v("\n      已定\n    ")]),t._v(" "),a("rs-nav-item",{attrs:{id:"3"}},[t._v("\n      未定\n    ")])],1),t._v(" "),a("div",{staticClass:"mui-content"},[t.DTSMESSAGE?a("div",{staticClass:"mui-content-padded f14 rr-text-center"},[t._v("\n      "+t._s(t.DTSMESSAGE)+"\n    ")]):t._e(),t._v(" "),a("rs-list",{staticClass:"rr-line-24",attrs:{size:"15",noborder:""}},t._l(t.DTSITEMS,function(e){return a("rs-list-item",{key:e.ENTRYID,nativeOn:{click:function(a){t.linkMat(e)}}},[a("div",{staticClass:"mui-clearfix"},[a("span",{staticClass:"rr-right"},[t._v(t._s(e.SIZETYPE))]),t._v("\n          "+t._s(e["MID.MNAME"])+"\n        ")]),t._v(" "),a("div",{},[e.QTY>=0?a("span",{staticClass:"rr-right"},[t._v(" "+t._s(t._f("toFixed")(e.PRC*e.QTY,2))+"(元)")]):t._e(),t._v("\n          数量:"),a("span",{staticClass:"rr-border rr-width-4em rr-text-center ml5",staticStyle:{height:"24px"}},[t._v(t._s(e.QTY))]),t._v(" "),a("span",{staticClass:"ml5 mr5"},[t._v("袋")]),t._v(" × "),a("span",{staticClass:"ml5 mr5"},[t._v(t._s(e.PRC))]),t._v("= \n        ")])])}))],1),t._v(" "),a("div",{staticClass:"f14 bk-fff rs-padding-5"},[t._v("订货金额："+t._s(t._f("toFixed")(t.AMT,2))+"(元)")])],1)},staticRenderFns:[]};var D=a("C7Lr")(l,E,!1,function(t){a("sMse")},"data-v-05e8c8c6",null);e.default=D.exports},za3j:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s={extends:a("js5j").a},r=a("C7Lr")(s,null,!1,null,null,null);e.default=r.exports}});
//# sourceMappingURL=2.4f31045c704d701fcaff.js.map